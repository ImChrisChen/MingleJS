/** * Created by WebStorm. * User: MacBook * Date: 2021/1/28 * Time: 5:22 下午 */import axios from 'axios';import { getBrowerInfo, getOS } from '@utils/util';// 通用日志字段interface ILog {    url: string    browser_name?: string    browser_ver?: string    os_name?: string    os_ver?: string}// 错误日志字段interface IErroLog extends ILog {    message: string    stack: string}// 请求日志interface IRequestLog extends ILog {    request_url: string    methods: string    content: any    headers: string}class Logger {}class ErrorLogger {}class RequestLogger {}export class Monitor {    constructor() {    }    public static async errorLogger(log: IErroLog) {        let { browser, ver } = getBrowerInfo();        log['browser_name'] = browser;        log['browser_ver'] = ver;        log['os_name'] = getOS();        log['os_ver'] = '';        console.log(log);        let res = await axios.post('/server/log', log);        console.log(res);    }    public static async requestLogger(log: IRequestLog) {    }    // 获取加载时间性能测速    public static getPerformanceTimes(cb: (times?: Array<any>) => any) {        let times: Array<any> = [];        let that = this;        let time = window.performance.timing;        let loadTime = (time.loadEventEnd - time.loadEventStart) / 1000;        if (loadTime < 0) {            setTimeout(() => {                that.getPerformanceTimes(cb);            }, 200);        } else {            let redirect = { name: '重定向时间', value: time.redirectEnd - time.redirectStart };            let domain = { name: 'DNS解析时间', value: (time.domainLookupEnd - time.domainLookupStart) };            let tcpconnect = { name: 'TCP完成握手时间', value: (time.connectEnd - time.connectStart) };            let response = { name: 'HTTP请求响应完成时间', value: (time.responseEnd - time.requestStart) };            let domload = { name: 'DOM开始加载前所花费时间', value: time.responseEnd - time.navigationStart };            let domend = { name: 'DOM结构解析完成时间', value: time.domInteractive - time.domLoading };            let scriptload = { name: '脚本加载时间', value: time.domContentLoadedEventEnd - time.domContentLoadedEventStart };            let onload = { name: 'onload事件时间', value: time.loadEventEnd - time.loadEventStart };            let pageload = {                name : '页面完全加载时间',                value: redirect.value + domain.value + tcpconnect.value + response.value + domload.value + domend.value,            };            times.push(redirect, domain, tcpconnect, response, domload, domend, scriptload, onload, pageload);            for (let item of times) {                item.unit = '毫秒(ms)';                console.log(item.name + ':' + item.value + item.unit);            }            cb(times);        }    }}